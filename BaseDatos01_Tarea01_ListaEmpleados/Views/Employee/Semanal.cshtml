@model BaseDatos01_Tarea01_ListaEmpleados.Models.PlanillaSem

<!-- Cabecera simplificada -->
<div class="card-header bg-primary text-white">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h3 class="mb-0">@Model.NombreCompleto</h3>
            <div class="d-flex gap-4 mt-2">
                <span><i class="bi bi-briefcase"></i> @Model.Puesto</span>
                <span><i class="bi bi-cash-coin"></i> @Model.SalarioHora.ToString("C")/hora</span>
            </div>
        </div>
        <div>
            <button class="btn btn-sm btn-light me-2">
                <i class="bi bi-printer"></i> Imprimir
            </button>
            <button class="btn btn-sm btn-light">
                <i class="bi bi-download"></i> Exportar
            </button>
        </div>
    </div>
</div>

<!-- Selector de semana -->
<div class="card-body py-2 bg-light">
    <div class="row align-items-center">
        <div class="col-md-8">
            <select class="form-select form-select-sm" id="semanaSelect">
                @foreach (var semana in Model.Semanas)
                {
                    <option value="@semana.FechaInicio.ToString("yyyy-MM-dd")">
                        Semana del @semana.FechaInicio.ToString("dd/MM/yyyy") al @semana.FechaFin.ToString("dd/MM/yyyy")
                    </option>
                }
            </select>
        </div>
        <div class="col-md-4 text-end">
            <span class="badge bg-info text-dark">
                <i class="bi bi-info-circle"></i> Actualizado: @DateTime.Now.ToString("g")
            </span>
        </div>
    </div>
</div>

<!-- Tabla de días -->
<div class="card-body p-0">
    <div class="table-responsive">
        <table class="table table-hover m-0">
            <thead class="table-dark">
                <tr>
                    <th>Día</th>
                    <th>Fecha</th>
                    <th class="text-end">Horas</th>
                    <th class="text-end">Salario</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                @{
                    var semanaActual = Model.Semanas.First();
                    var diasSemana = new[] { "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado", "Domingo" };
                }

                @for (int i = 0; i < 7; i++)
                {
                    var fecha = semanaActual.FechaInicio.AddDays(i);
                    <tr>
                        <td>@diasSemana[i]</td>
                        <td>@fecha.ToString("dd/MM/yyyy")</td>
                        <td class="text-end @(semanaActual.HorasPorDia[i] == 0 ? "text-muted" : "fw-bold")">
                            @semanaActual.HorasPorDia[i]
                        </td>
                        <td class="text-end">
                            @((semanaActual.HorasPorDia[i] * Model.SalarioHora).ToString("C"))
                        </td>
                        <td>
                            @if (semanaActual.HorasPorDia[i] == 0)
                            {
                                <span class="badge bg-secondary">Libre</span>
                            }
                            else if (semanaActual.HorasPorDia[i] > 8)
                            {
                                <span class="badge bg-warning text-dark">Extras</span>
                            }
                            else
                            {
                                <span class="badge bg-success">Normal</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Resumen financiero -->
<div class="card-body">
    <div class="row">
        <div class="col-md-4 mb-3">
            <div class="p-3 border border-success rounded">
                <h5 class="text-success">Salario Bruto</h5>
                <h3 class="text-success">@semanaActual.SalarioBruto.ToString("C")</h3>
                <small class="text-muted">@semanaActual.HorasTotales horas trabajadas</small>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="p-3 border border-danger rounded">
                <h5 class="text-danger">Descuentos</h5>
                <h3 class="text-danger">@semanaActual.Descuentos.ToString("C")</h3>
                <small class="text-muted">@semanaActual.MotivoDescuento</small>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="p-3 border border-primary rounded">
                <h5 class="text-primary">Salario Neto</h5>
                <h3 class="text-primary">@semanaActual.SalarioNeto.ToString("C")</h3>
                <small class="text-muted">Líquido a pagar</small>
            </div>
        </div>
    </div>
</div>

<!-- Historial -->
<div class="card-footer">
    <h5 class="mb-3"><i class="bi bi-clock-history"></i> Historial Reciente</h5>
    <div class="table-responsive">
        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Semana</th>
                    <th class="text-end">Horas</th>
                    <th class="text-end">Bruto</th>
                    <th class="text-end">Neto</th>
                    <th width="50px"></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var semana in Model.Semanas)
                {
                    <tr>
                        <td>@semana.FechaInicio.ToString("dd/MM") - @semana.FechaFin.ToString("dd/MM")</td>
                        <td class="text-end">@semana.HorasTotales</td>
                        <td class="text-end">@semana.SalarioBruto.ToString("C")</td>
                        <td class="text-end">@semana.SalarioNeto.ToString("C")</td>
                        <td class="text-end">
                            <button class="btn btn-sm btn-outline-secondary">
                                <i class="bi bi-eye"></i>
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>